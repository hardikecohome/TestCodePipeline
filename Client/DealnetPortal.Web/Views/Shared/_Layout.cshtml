@using DealnetPortal.Api.Core.Helpers
@using DealnetPortal.Web.Infrastructure
@using DealnetPortal.Web.Models.Enumeration
@using System.Security.Claims;
@using System.Configuration;

<!DOCTYPE html>
<html lang="@(CultureHelper.CurrentCultureType == CultureType.English ? "en-CA" : "fr-CA")">
<!--[if IE 9 ]><html lang="@(CultureHelper.CurrentCultureType == CultureType.English ? "en-CA" : "fr-CA")" class="ie9"><![endif]-->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <title>@ViewBag.Title - DealNet</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i,900" rel="stylesheet" type='text/css'>
    <link rel="stylesheet" href="~/Content/css/jquery-ui.css">
    @RenderSection("Styles", false)
    @switch (ApplicationSettingsManager.PortalType)
    {
        case PortalType.Ecohome:
        default:
            @Styles.Render("~/Content/less/main.less")
            break;
        case PortalType.Odi:
            @Styles.Render("~/Content/less/main-dealer.less")
            break;
    }
    <link rel="shortcut icon" href=@Url.Action("Favicon", "Settings", new { version = DateTime.Now.Ticks.ToString(), hashDealerName = ViewBag.HashDealerName as string }) type="image/x-icon" />
    <script type="text/javascript">
        //Next two lines for IE (God Damn It! What is that shit made of?!)
        if (!window.console) window.console = {};
        if (!window.console.log) window.console.log = function () { };
        // global formatNumber function Todo: remove global variables
        window.formatNumber = function(num) {
            if (typeof num === 'number') {
                return num.toFixed(2);
            }
            return num;
        };
        var urlContent = "@Url.Content("~/")";
        var layotSettingsUrl = "@(User.Identity.IsAuthenticated ? Url.Action("LayoutSettings", "Home") : null)";
        var customerDealsCountUrl = "@(User.Identity.IsAuthenticated ? Url.Action("CustomersDealsCount", "Home") : null)";
        var translations = {};
        translations['IfYouChangeInfo'] = "@Resources.IfYouChangeInfo";
        translations['NavigateToStep'] = "@Resources.NavigateToStep";
        translations['GoToStep'] = "@Resources.GoToStep";
        translations['ThisFieldIsRequired'] = "@Resources.ThisFieldIsRequired";
        translations['EnterValidDate'] = "@Resources.EnterValidDate";
        translations['Cancel'] = "@Resources.Cancel";
        @RenderSection("Translations", false)
    </script>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/dealnet")
    @switch (CultureHelper.CurrentCultureType)
    {
        case CultureType.French:
            <script type="text/javascript"
                    src="https://cdn.rawgit.com/jquery/jquery-ui/master/ui/i18n/datepicker-fr.js">
            </script>
            <script type="text/javascript">
                $.datepicker.regional['fr'].dayNamesMin = ['di', 'lu', 'ma', 'me', 'je', 've', 'sa'];
                $.datepicker.regional['fr'].monthNamesShort = [ "janvier", "février", "mars", "avril", "mai", "juin",
		"juillet", "août", "septembre", "octobre", "novembre", "décembre" ];
                $.datepicker.setDefaults($.datepicker.regional['fr']);
            </script>
            break;
    }
    @RenderSection("OutrunningScripts", false)
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.7.1/less.min.js"></script>-->
    @Html.Raw(System.Configuration.ConfigurationManager.AppSettings["GoogleAnalyticsScript"])

</head>
@{
    string themeClass;
    switch (ApplicationSettingsManager.PortalType)
    {
        case PortalType.Ecohome:
        default:
            themeClass = "";
            break;
        case PortalType.Odi:
            themeClass = "theme-one-dealer";
            break;
    }
}

<body class="@(User.Identity.IsAuthenticated ? "authorized" : "no-authorized") @themeClass">
	<div class="container-fluid">
		<div class="row">
            <div class="col-md-12">
                <nav class="navbar navbar-inverse navbar-fixed-side">
                    <div class="navbar-header">
                        @if (User.Identity.IsAuthenticated)
                        {
                            <div class="burger-hold">
                                <button class="navbar-toggle pull-left" data-target=".navbar-collapse" data-toggle="collapse">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                            </div>
                            <div class="logo-container">
                                <div class="dealnet-image-ecologo main-logo"></div>
                            </div>
                        }
						
                        <div class="user-hold">
                            <div class="dealnet-login-buttons-holder pull-right">
                                @Html.Partial("LoginButtons")
                            </div>
                            @if (User.Identity.IsAuthenticated && ((bool?)TempData["LangSwitcherAvailable"] ?? false))
                            {
                            <div class="lang-switcher pull-right">
                                <div class="chosen-language">
                                    <div class="lang-item">
                                        <a href="#" class="chosen-language-link">
                                            @switch (CultureHelper.CurrentCultureType)
                                            {
                                                case CultureType.English:
                                                    @:English
                                                    break;
                                                case CultureType.French:
                                                    @:Français
                                                    break;
                                            }
                                            <span class="caret"></span>
                                        </a>
                                    </div>
                                </div>
                                <ul class="lang-list">
                                    @if (CultureHelper.CurrentCultureType != CultureType.English)
                                    {
                                        <li class="lang-item active">
                                            @Html.ActionLink(Resources.English, "ChangeCulture", "Home", new {culture = "en"}, new {@class = "lang-link"})
                                        </li>
                                    }
                                    @if (CultureHelper.CurrentCultureType != CultureType.French)
                                    {
                                        <li class="lang-item">
                                            @Html.ActionLink(Resources.French, "ChangeCulture", "Home", new {culture = "fr"}, new {@class = "lang-link"})
                                        </li>
                                    }
                                </ul>
                            </div>
                            }
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        <div class="row">
            @if (User.Identity.IsAuthenticated)
            {
            <div class="dealnet-sidebar collapse navbar-collapse" aria-expanded="false">
                <div class="sidebar-inner">
                    <div class="sidebar-row sidebar-row-expanded">
                        <div class="dealnet-sidebar-header">
                            <div class="dealnet-image-ecologo"></div>
                            <button class="navbar-toggle pull-right" data-target=".navbar-collapse" data-toggle="collapse">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                        </div>
                        @if (Request.IsAuthenticated)
                        {
                        {
                        @*@Html.AntiForgeryToken()*@
                        <div class="dealnet-sidebar-user">
                        <span class="icon-circle-hold">
                            <svg aria-hidden="true" class="icon icon-user-small"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-user-small")"></use></svg>
                        </span> @User.Identity.Name
                        </div>

                        }
                        }
                        <ul class="nav nav-sidebar">
                            @if ((User as ClaimsPrincipal)?.IsInRole("MortgageBroker") != true)
                            {
                                <li class="dealnet-sidebar-item" id="sidebar-item-homepage">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-home"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-home")"></use></svg></span>
                                    @Html.ActionLink(Resources.HomePage, "Index", "Home", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item" id="sidebar-item-newrental">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-new-rental-side"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-new-rental-side")"></use></svg></span>
                                    @Html.ActionLink(Resources.NewApplication, "BasicInfo", "NewRental", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item" id="sidebar-item-mydeals">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-my-deals-side"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-my-deals-side")"></use></svg></span>
                                    @Html.ActionLink(Resources.MyDeals, "Index", "MyDeals", null, new {@class = "dealnet-sidebar-link"})
                                    <span class="new-deals-number collapse" id="new-deals-number" ></span>
                                </li>
                                <li class="dealnet-sidebar-item" id="sidebar-item-reports">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-reports-side"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-reports-side")"></use></svg></span>
                                    @Html.ActionLink(Resources.Reports, "Index", "Reports", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item" id="sidebar-item-calculator">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-calculator"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-calculator")"></use></svg></span>
                                    @Html.ActionLink(Resources.Calculator, "Index", "Calculator", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-share-link"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-share-link")"></use></svg></span>
                                    @Html.ActionLink(Resources.ShareableLink, "Index", "ShareableLink", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-list-request"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-list-request")"></use></svg></span>
                                    @Html.ActionLink("Leads", "Index", "Leads", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-my-account-one-person"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-my-account-one-person")"></use></svg></span>
                                    @Html.ActionLink("My Profile", "Index", "Profile", null, new {@class = "dealnet-sidebar-link"})
                                </li>

                                if ((User as ClaimsPrincipal)?.HasClaim("ShowAbout", "True") ?? false)
                                {
                                    <li class="dealnet-sidebar-item">
                                        <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-info"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-info")"></use></svg></span>
                                        @Html.ActionLink(Resources.AboutUs, "About", "Home", null, new { @class = "dealnet-sidebar-link" })
                                    </li>
                                }
                                <li class="dealnet-sidebar-item" id="sidebar-item-help">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-help-page"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-help-page")"></use></svg></span>
                                    @Html.ActionLink(Resources.Help, "Help", "Home", null, new {@class = "dealnet-sidebar-link", target = "_blank"})
                                </li>
                            }
                            @if ((User as ClaimsPrincipal)?.IsInRole("MortgageBroker") == true)
                            {
                                <li class="dealnet-sidebar-item">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-new-client"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-new-client")"></use></svg></span>
                                    @Html.ActionLink("New Client", "NewClient", "MortgageBroker", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                                <li class="dealnet-sidebar-item">
                                    <span class="sidebar-icon"><svg aria-hidden="true" class="icon icon-my-account"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-my-account")"></use></svg></span>
                                    @Html.ActionLink("My Clients", "MyClients", "MortgageBroker", null, new {@class = "dealnet-sidebar-link"})
                                </li>
                            }
                        </ul>

                    </div>


                    <div class="sidebar-bottom sidebar-row">
                        @if (((bool?)TempData["LangSwitcherAvailable"] ?? false))
                        {
                            <div class="dealnet-sidebar-item sidebar-lang-item">
                                    @switch (CultureHelper.CurrentCultureType)
                                    {
                                        case CultureType.English:
                                            @:@Html.ActionLink("Switch to French", "ChangeCulture", "Home", new {culture = "fr"}, new {@class = "dealnet-sidebar-link no-icon"})
                                            break;
                                        case CultureType.French:
                                            @:@Html.ActionLink("Switch to English", "ChangeCulture", "Home", new {culture = "en"}, new {@class = "dealnet-sidebar-link no-icon"})
                                            break;
                                    }
                            </div>
                        }
                        <div class="dealnet-sidebar-item">
                            @Html.ActionLink(Resources.Logout, "LogOff", "Account", null, new { @class = "dealnet-sidebar-link no-icon" })
                        </div>
                    </div>
                </div>
            </div>
            }
            <div class="@(User.Identity.IsAuthenticated ? "col-md-9 col-lg-10 col-md-offset-3 col-lg-offset-2 dealnet-body-container" : "col-md-12 col-lg-12")">				
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 dealnet-body">
						@if (ConfigurationManager.AppSettings["SwitchPopUpOnOff"] == "true")
						{
						<div class="row" id="alertLine">
															
								<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
									<div class="pull-right" id="alertCloseButton">
										<button type="button" class="btn btn-small btn-warning btn-circle"
												style="width: 20px; height: 20px; text-align: center; padding: 1px 0; font-size: 12px; line-height: 1.428571429; border-radius: 10px;"
												onclick="$('#alertLine').hide(); sessionStorage['Alert'] = 'closed';">
											<i class="glyphicon glyphicon-remove"></i>
										</button>
									</div>
									<p><strong style="color:red;">@ConfigurationManager.AppSettings["PopUpHeader"]</strong> <br />@ConfigurationManager.AppSettings["PopUpMessage"]</p>
								</div>								
							
						</div>
						}
                        @RenderBody()
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="overlay"></div>

<div id="alertModal" class="modal fade modal-wide">
    <div class="modal-dialog modal-warning">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body">
                <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
                <div class="btn-container">
                    <button type="button" class="btn dealnet-button dealnet-success-button block-button big-button" id="confirmAlert">@Resources.Yes</button>
                    <button type="button" class="btn dealnet-button dealnet-link-button block-button big-button" data-dismiss="modal">@Resources.Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>

	<div id="emailModal" class="modal fade modal-wide">
		<div class="modal-dialog modal-warning">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title">Dealer Support: How Can We Help? </h4>
				</div>			`	
				<div class="modal-body">
					<div class="col-md-12 pull-left" style="margin-bottom:20px;">
						<div class="row">
							<div class="form-group">
								<div class="col-md-3">
									<label class="pull-left">Dealer Name</label>
								</div>
								<div class="col-md-9">
									<label class="pull-left" id="emailDealerName">@User.Identity.Name</label>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group">
								<div class="col-md-3">
									<label class="pull-left">Your Name</label>
								</div>
								<div class="col-md-9">
									<label class="pull-left" id="emailSubDealerName">@User.Identity.Name</label>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group">
								<div class="col-md-3">
									<label class="pull-left">Loan Number</label>
								</div>
								<div class="col-md-9">
									<label class="pull-left" id="emailTransactionId"></label>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group">
								<div class="col-md-3">
									<label class="pull-left">How Can We Help?</label>
								</div>
								<div class="col-md-9">
									<textarea class="form-control pull-left full-width" id="emailComment" rows="3"></textarea>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group">
								<div class="col-md-3">
									<label class="pull-left">Best Way to get back to you</label>
								</div>
								<div class="col-md-9">
									<div class="row">
										<div class="col-md-12">
											<label class="pull-left align-middle custom-checkbox">
												<input type="checkbox" class="dealnet-checkbox" id="emailPhone" />
												<span class="checkbox-icon"><svg aria-hidden="true" class="icon icon-checked"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-checked")"></use></svg></span>
												<span>@Resources.Phone</span>
											</label>
										</div>
									</div>
									<div class="row">
										<div class="col-md-12">
											<label class="pull-left align-middle custom-checkbox">
												<input type="checkbox" class="dealnet-checkbox" id="emailSameEmail" />
												<span class="checkbox-icon"><svg aria-hidden="true" class="icon icon-checked"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-checked")"></use></svg></span>
												<span>Same E-mail</span>
											</label>
										</div>
									</div>
									<div class="row">
										<div class="col-md-12">
											<label class="pull-left align-middle custom-checkbox">
												<input type="checkbox" class="dealnet-checkbox" id="emailAlternativeEmail" />
												<span class="checkbox-icon"><svg aria-hidden="true" class="icon icon-checked"><use xlink:href="@Url.Content("~/Content/images/sprite/sprite.svg#icon-checked")"></use></svg></span>
												<span>Alternative E-mail</span>
											</label>
											<input class="pull-left form-control dealnet-input" type="text" id="emailAlternativeEmailAddress" />
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					
				</div>
				<div class="modal-footer">
					<div class="col-md-12">
						<button type="button" class="btn dealnet-button dealnet-link-button" data-dismiss="modal">@Resources.Cancel</button>
						<button type="button" class="btn dealnet-button dealnet-success-button" id="emailSupport" onclick="sendEmailToDealerSupport();">@Resources.Send</button>
					</div>
				</div>
			</div>
		</div>
	</div>
    @RenderSection("Scripts", false)
</body>
</html>
